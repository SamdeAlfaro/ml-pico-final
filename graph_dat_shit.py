import matplotlib.pyplot as plt

def plot_loss_array(data, labels=None, title="Three Arrays Plot"):
    full_list = []
    index_of_epoch = []
    for it,i in enumerate(data):
        for x in i:
            full_list.append(x)
        if it%2 !=0:
            index_of_epoch.append(i)
    print(full_list)
    
    plt.figure(figsize=(10, 6))
    plt.plot(full_list, linestyle='-', marker='o')
    for it, idx in enumerate(index_of_epoch):
        plt.axvline(full_list.index(idx[0]), color='r', linestyle='--', label=f'Epoch {it+1} Avg = {format(idx[0], ".2f")}')
        plt.text(full_list.index(idx[0])+.1,idx[0]+.1, f'Epoch {it+1}', color='r', rotation=0, verticalalignment='top')
    plt.title(title)
    plt.xlabel("Time / Number of Steps")
    plt.ylabel("Loss")
    plt.legend()
    plt.grid(True)
    plt.show()


#plot_loss_array(title = "Losses From kvcache_transformer",data=[[4.199302401542663, 3.4113633537292483, 3.258089120388031, 3.1482773303985594, 3.080840380191803, 3.1210873341560363, 3.0148148107528687, 3.017436385154724, 2.9711909341812133, 2.9459087252616882, 2.912661771774292, 2.920338704586029, 2.8921641898155213, 2.8227937960624696, 2.8707573795318604, 2.8440470266342164, 2.852559130191803, 2.84852667093277, 2.776403293609619, 2.8204926085472106, 2.775706105232239, 2.7806589436531066, 2.739989423751831, 2.772708387374878, 2.7467004919052123, 2.7446180820465087, 2.7434969878196718, 2.713144941329956, 2.7368308305740356, 2.7477275681495668, 2.722485718727112, 2.69140771150589, 2.680476131439209, 2.7313944411277773, 2.69876157283783, 2.686821119785309, 2.7043461298942564, 2.7162069964408873, 2.7120719861984255, 2.7193047165870667], [2.87723861343693], [2.69912273645401, 2.712525372505188, 2.689803569316864, 2.6415873885154726, 2.612236657142639, 2.676964819431305, 2.6259980487823484, 2.673305034637451, 2.6116139483451843, 2.6744290947914124, 2.6603574657440188, 2.644833118915558, 2.670279960632324, 2.6382248830795287, 2.594194779396057, 2.6399007844924927, 2.610592906475067, 2.640775616168976, 2.663602845668793, 2.621715240478516, 2.622649962902069, 2.617903470993042, 2.625089495182037, 2.627944746017456, 2.6077215051651, 2.6039976358413695, 2.627590820789337, 2.6317641162872314, 2.6037036275863645, 2.6003675866127014, 2.6045136427879334, 2.588415117263794, 2.6029238533973693, 2.5933667063713073, 2.593206915855408, 2.591203851699829, 2.5923985028266907, 2.5751619148254394, 2.5771811032295227, 2.5865890431404113], [2.626321213960182], [2.580257840156555, 2.6072060751914976, 2.5676834273338316, 2.5926680755615235, 2.6093107748031614, 2.580241334438324, 2.60234650850296, 2.570570924282074, 2.56313670873642, 2.56593932390213, 2.591249523162842, 2.571362643241882, 2.589355561733246, 2.5713967061042786, 2.5691329932212827, 2.573167135715485, 2.5823385524749756, 2.555531847476959, 2.575522882938385, 2.5760721135139466, 2.578201298713684, 2.5801306700706483, 2.5651736664772034, 2.5454420185089113, 2.5510019087791442, 2.535986831188202, 2.5399176812171937, 2.5503931641578674, 2.5846326327323914, 2.588591158390045, 2.553038556575775, 2.5250357484817503, 2.5390938091278077, 2.52086820602417, 2.5269251251220703, 2.535305515527725, 2.5309906220436096, 2.542776687145233, 2.532860186100006, 2.537882342338562], [2.5635478029435035]])